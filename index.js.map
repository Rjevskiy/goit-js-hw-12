{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImages(query, page = 1) {\n    const API_KEY = '46859112-8db04929d193e6e9d044d366e';\n    const BASE_URL = 'https://pixabay.com/api/';\n    const url = `${BASE_URL}?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&per_page=100&page=${page}`;\n\n    const response = await axios.get(url);\n    if (response.status !== 200) {\n        throw new Error('Ошибка при получении данных');\n    }\n\n    // Возвращаем `hits` и `totalHits` для дальнейшей проверки\n    return {\n        images: response.data.hits,\n        totalHits: response.data.totalHits\n    };\n}\n","export function displayImages(images, clear = false) {\n    const gallery = document.getElementById('gallery');\n    if (clear) gallery.innerHTML = ''; // Очищаем галерею, если clear = true\n\n    const markup = images.map(image => `\n        <div class=\"gallery-item\">\n            <a href=\"${image.largeImageURL}\" class=\"lightbox\">\n                <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n            </a>\n            <div class=\"info\">\n                <p>Likes: ${image.likes}</p>\n                <p>Views: ${image.views}</p>\n                <p>Comments: ${image.comments}</p>\n                <p>Downloads: ${image.downloads}</p>\n            </div>\n        </div>\n    `).join('');\n\n    gallery.insertAdjacentHTML('beforeend', markup); // Добавляем разметку к существующим элементам\n}\n","import { fetchImages } from './js/pixabay-api.js';\nimport { displayImages } from './js/render-functions.js';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.getElementById('search-form');\nconst input = document.getElementById('search-input');\nconst loader = document.getElementById('loader');\nconst loadMoreButton = document.getElementById('load-more');\nlet lightbox;\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\nlightbox = new SimpleLightbox('.gallery-item a', {\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250\n});\n\n// Функция для загрузки изображений\nasync function loadImages(query, page = 1) {\n    try {\n        loader.style.display = 'block';\n        const { images, totalHits: hits } = await fetchImages(query, page);\n\n        if (page === 1) {\n            totalHits = hits;\n            displayImages(images, true);\n        } else {\n            displayImages(images, false);\n        }\n\n        lightbox.refresh();\n        const currentImageCount = document.querySelectorAll('.gallery-item').length;\n\n        // Получаем высоту одной карточки галереи\n        const galleryItem = document.querySelector('.gallery-item');\n        const cardHeight = galleryItem ? galleryItem.getBoundingClientRect().height : 0;\n\n        // Прокручиваем страницу на две высоты карточки\n        if (cardHeight > 0) {\n            window.scrollBy({\n                top: 2 * cardHeight, // Прокручиваем на 2 высоты карточки\n                behavior: 'smooth' // Плавная прокрутка\n            });\n        }\n\n        // Проверка: скрыть кнопку и показать сообщение, если все результаты загружены\n        if (currentImageCount >= totalHits) {\n            loadMoreButton.style.display = 'none';\n            iziToast.info({\n                title: \"Info\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight'\n            });\n        } else {\n            loadMoreButton.style.display = 'block';\n        }\n    } catch (error) {\n        iziToast.error({\n            title: \"Error\",\n            message: \"Failed to fetch images. Please try again later.\",\n            position: 'topRight'\n        });\n    } finally {\n        loader.style.display = 'none';\n    }\n}\n\n// Обработчик формы\nform.addEventListener('submit', (event) => {\n    event.preventDefault();\n    const query = input.value.trim();\n\n    if (!query) {\n        iziToast.warning({\n            title: \"Warning\",\n            message: \"Please enter a search query!\",\n            position: 'topRight'\n        });\n        return;\n    }\n\n    currentQuery = query;\n    currentPage = 1;\n    loadMoreButton.style.display = 'none';\n    loadImages(currentQuery, currentPage);\n});\n\n// Обработчик для кнопки \"Load More\"\nloadMoreButton.addEventListener('click', () => {\n    currentPage += 1;\n    loadImages(currentQuery, currentPage);\n});\n\n"],"names":["fetchImages","query","page","url","response","axios","displayImages","images","clear","gallery","markup","image","form","input","loader","loadMoreButton","lightbox","currentPage","currentQuery","totalHits","SimpleLightbox","loadImages","hits","currentImageCount","galleryItem","cardHeight","iziToast","event"],"mappings":"owBAEO,eAAeA,EAAYC,EAAOC,EAAO,EAAG,CAG/C,MAAMC,EAAM,qEAAgCF,CAAK,8EAA8EC,CAAI,GAE7HE,EAAW,MAAMC,EAAM,IAAIF,CAAG,EACpC,GAAIC,EAAS,SAAW,IACpB,MAAM,IAAI,MAAM,6BAA6B,EAIjD,MAAO,CACH,OAAQA,EAAS,KAAK,KACtB,UAAWA,EAAS,KAAK,SACjC,CACA,CCjBO,SAASE,EAAcC,EAAQC,EAAQ,GAAO,CACjD,MAAMC,EAAU,SAAS,eAAe,SAAS,EAC7CD,IAAOC,EAAQ,UAAY,IAE/B,MAAMC,EAASH,EAAO,IAAII,GAAS;AAAA;AAAA,uBAEhBA,EAAM,aAAa;AAAA,4BACdA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA,4BAGtCA,EAAM,KAAK;AAAA,4BACXA,EAAM,KAAK;AAAA,+BACRA,EAAM,QAAQ;AAAA,gCACbA,EAAM,SAAS;AAAA;AAAA;AAAA,KAG1C,EAAE,KAAK,EAAE,EAEVF,EAAQ,mBAAmB,YAAaC,CAAM,CAClD,CCZA,MAAME,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAQ,SAAS,eAAe,cAAc,EAC9CC,EAAS,SAAS,eAAe,QAAQ,EACzCC,EAAiB,SAAS,eAAe,WAAW,EAC1D,IAAIC,EAEAC,EAAc,EACdC,EAAe,GACfC,EAAY,EAEhBH,EAAW,IAAII,EAAe,kBAAmB,CAC7C,SAAU,GACV,aAAc,MACd,aAAc,GAClB,CAAC,EAGD,eAAeC,EAAWpB,EAAOC,EAAO,EAAG,CACvC,GAAI,CACAY,EAAO,MAAM,QAAU,QACvB,KAAM,CAAE,OAAAP,EAAQ,UAAWe,CAAI,EAAK,MAAMtB,EAAYC,EAAOC,CAAI,EAE7DA,IAAS,GACTiB,EAAYG,EACZhB,EAAcC,EAAQ,EAAI,GAE1BD,EAAcC,EAAQ,EAAK,EAG/BS,EAAS,QAAO,EAChB,MAAMO,EAAoB,SAAS,iBAAiB,eAAe,EAAE,OAG/DC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAaD,EAAcA,EAAY,sBAAuB,EAAC,OAAS,EAG1EC,EAAa,GACb,OAAO,SAAS,CACZ,IAAK,EAAIA,EACT,SAAU,QAC1B,CAAa,EAIDF,GAAqBJ,GACrBJ,EAAe,MAAM,QAAU,OAC/BW,EAAS,KAAK,CACV,MAAO,OACP,QAAS,6DACT,SAAU,UAC1B,CAAa,GAEDX,EAAe,MAAM,QAAU,OAEtC,MAAe,CACZW,EAAS,MAAM,CACX,MAAO,QACP,QAAS,kDACT,SAAU,UACtB,CAAS,CACT,QAAc,CACNZ,EAAO,MAAM,QAAU,MAC1B,CACL,CAGAF,EAAK,iBAAiB,SAAWe,GAAU,CACvCA,EAAM,eAAc,EACpB,MAAM1B,EAAQY,EAAM,MAAM,KAAI,EAE9B,GAAI,CAACZ,EAAO,CACRyB,EAAS,QAAQ,CACb,MAAO,UACP,QAAS,+BACT,SAAU,UACtB,CAAS,EACD,MACH,CAEDR,EAAejB,EACfgB,EAAc,EACdF,EAAe,MAAM,QAAU,OAC/BM,EAAWH,EAAcD,CAAW,CACxC,CAAC,EAGDF,EAAe,iBAAiB,QAAS,IAAM,CAC3CE,GAAe,EACfI,EAAWH,EAAcD,CAAW,CACxC,CAAC"}